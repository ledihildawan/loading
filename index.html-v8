<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Loader v8.0 - Visual Perfection</title>
    <style>
        /* ==========================================================================
           1. CSS CUSTOM PROPERTIES (ADVANCED OKLCH)
           ========================================================================== */
        :root {
            /* Base Lightness untuk konsistensi di layar HDR */
            --gl-l: 100%;
            --gl-c: 0;
            --gl-h: 0;

            --gl-color-full: oklch(var(--gl-l) var(--gl-c) var(--gl-h));
            --gl-beam-high: oklch(var(--gl-l) var(--gl-c) var(--gl-h) / 85%);
            --gl-beam-low: oklch(var(--gl-l) var(--gl-c) var(--gl-h) / 20%);
            
            --gl-height: .125rem;
            --gl-z-index: 10001;
            --gl-motion-slow: 1.2s;
            --gl-motion-normal: 0.4s;
        }

        /* ==========================================================================
           2. GLOBAL LOADER (BEM + VISUAL POLISH)
           ========================================================================== */
        .global-loader {
            position: fixed;
            z-index: var(--gl-z-index);
            top: 0; left: 0; width: 100%;
            height: var(--gl-height);
            opacity: 0;
            transition: opacity var(--gl-motion-normal) cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
            will-change: opacity;
        }

        .global-loader--is-visible {
            opacity: 1;
            transition: opacity var(--gl-motion-slow) linear;
        }

        .global-loader__bar {
            position: fixed;
            top: 0; left: 0;
            width: 100.5vw;
            height: var(--gl-height);
            border-radius: 9999px;
            transform: translate3d(-100%, 0, 0.5px);
            transition: transform .4s cubic-bezier(0.23, 1, 0.32, 1);
            will-change: transform;
        }

        /* Texture Shimmer Overlay */
        .global-loader__bar::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            opacity: 0.03;
            mix-blend-mode: overlay;
        }

        /* Speed & Logic Modifiers */
        .global-loader__bar--rushing { transition: transform .2s linear !important; }
        .global-loader__bar--complete { transition: transform .3s cubic-bezier(0.7, 0, 0.3, 1) !important; }
        .global-loader__bar--instant { transition: none !important; }

        .global-loader__background {
            width: 100%; height: 100%;
            background: linear-gradient(90deg, var(--gl-beam-low) 0%, var(--gl-beam-high) 100%);
            border-radius: inherit;
        }

        /* Dynamic Glow System */
        .global-loader__glow-container {
            position: absolute;
            top: 50%; right: 0;
            width: 40rem; height: var(--gl-height);
            transform: translate3d(0, -50%, 0);
            opacity: 0.5;
            transition: opacity 0.6s ease, filter 0.6s ease;
        }

        /* Bloom Effect saat Rushing */
        .global-loader__bar--rushing .global-loader__glow-container {
            opacity: 1;
            filter: brightness(2) blur(1px);
        }

        .global-loader__glow-layer {
            position: absolute;
            top: 50%; right: 0;
            width: 100%; height: 100%;
            border-radius: 9999px;
            transform: translate3d(0, -50%, 0);
            background: linear-gradient(90deg, transparent 0%, var(--gl-color-full) 100%);
        }

        /* Precise Multi-layer Blur */
        .global-loader__glow-layer--1 { right: -1px; width: 10%; filter: blur(1px); }
        .global-loader__glow-layer--2 { right: -2px; width: 20%; filter: blur(4px); }
        .global-loader__glow-layer--3 { right: -5px; width: 30%; filter: blur(12px); opacity: 0.6; }
        .global-loader__glow-layer--4 { height: 400%; filter: blur(25px); opacity: 0.4; }
        .global-loader__glow-layer--5 { right: -20px; height: 1000%; filter: blur(50px); opacity: 0.2; }

        /* Swoosh Animation */
        .global-loader__swoosh-container {
            position: absolute;
            inset: 0; overflow: hidden;
            border-radius: inherit;
        }

        .global-loader__swoosh-animation {
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent 0%, transparent 20%, oklch(100% 0 0 / 20%) 50%, transparent 80%, transparent 100%);
            animation: gl-swoosh-move 1.5s infinite linear;
        }

        @keyframes gl-swoosh-move {
            0% { transform: translate3d(-100%, 0, 0); }
            100% { transform: translate3d(100%, 0, 0); }
        }

        @keyframes gl-shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Demo UI */
        body { background: oklch(10% 0 0); display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: sans-serif; color: white; }
        .panel { text-align: center; background: oklch(100% 0 0 / 2%); padding: 60px; border-radius: 32px; border: 1px solid oklch(100% 0 0 / 5%); box-shadow: 0 40px 100px -20px black; }
        .btn { background: white; color: black; border: none; padding: 16px 32px; border-radius: 12px; cursor: pointer; font-weight: 700; margin: 10px; transition: 0.3s cubic-bezier(0.2, 0, 0, 1); }
        .btn:hover { transform: scale(1.05); filter: brightness(1.1); }
        .btn--finish { background: oklch(85% 0.18 100); }
    </style>
</head>
<body>

    <div id="gl-wrapper" class="global-loader" aria-hidden="true">
        <div id="gl-bar" class="global-loader__bar" role="progressbar">
            <div class="global-loader__background"></div>
            <div class="global-loader__glow-container">
                <div class="global-loader__glow-layer global-loader__glow-layer--1"></div>
                <div class="global-loader__glow-layer global-loader__glow-layer--2"></div>
                <div class="global-loader__glow-layer global-loader__glow-layer--3"></div>
                <div class="global-loader__glow-layer global-loader__glow-layer--4"></div>
                <div class="global-loader__glow-layer global-loader__glow-layer--5"></div>
            </div>
            <div class="global-loader__swoosh-container">
                <div class="global-loader__swoosh-animation"></div>
            </div>
        </div>
    </div>

    <div class="panel">
        <h1 style="font-weight: 200; letter-spacing: 4px; margin-bottom: 40px;">ELITE LOADER v8.0</h1>
        <button class="btn" onclick="GlobalLoader.start()">Simulasikan Request</button>
        <button class="btn btn--finish" onclick="GlobalLoader.finish()">Selesaikan</button>
    </div>

    <script>
        const GlobalLoader = (() => {
            const dom = {
                wrapper: document.getElementById('gl-wrapper'),
                bar: document.getElementById('gl-bar'),
            };

            let state = { progress: -100, isActive: false, frameId: null };

            const render = () => {
                dom.bar.style.transform = `translate3d(${state.progress}%, 0, 0.5px)`;
                // Elastic Morphology: Jika progress kecil, buat ujung bar lebih bulat
                dom.bar.style.borderRadius = state.progress < -95 ? '0 9999px 9999px 0' : '9999px';
            };

            const creep = () => {
                if (!state.isActive) return;
                
                // Zeno's Paradox with Bucketing
                let factor = state.progress < -40 ? 0.03 : (state.progress < -10 ? 0.01 : 0.001);
                state.progress += (-0.8 - state.progress) * factor;

                render();
                state.frameId = requestAnimationFrame(creep);
            };

            return {
                start() {
                    if (state.isActive) return;
                    this.reset();
                    state.isActive = true;

                    requestAnimationFrame(() => {
                        dom.wrapper.classList.add('global-loader--is-visible');
                        dom.bar.classList.add('global-loader__bar--rushing');
                        state.progress = -65;
                        render();

                        setTimeout(() => {
                            if (!state.isActive) return;
                            dom.bar.classList.remove('global-loader__bar--rushing');
                            creep();
                        }, 250);
                    });
                },

                finish() {
                    if (!state.isActive) return;
                    state.isActive = false;
                    cancelAnimationFrame(state.frameId);

                    dom.bar.classList.add('global-loader__bar--complete');
                    state.progress = 0;
                    render();

                    setTimeout(() => {
                        dom.wrapper.classList.remove('global-loader--is-visible');
                        setTimeout(() => this.reset(), 1200);
                    }, 400);
                },

                reset() {
                    state.isActive = false;
                    cancelAnimationFrame(state.frameId);
                    state.progress = -100;
                    dom.bar.className = "global-loader__bar global-loader__bar--instant";
                    render();
                }
            };
        })();
    </script>
</body>
</html>